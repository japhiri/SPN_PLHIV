Bootstrap: docker
From: ubuntu:20.04

%environment
    LANG=en_US.UTF-8
    LC_ALL=en_US.UTF-8
    PATH=/opt/cellranger:$PATH

%post
    export DEBIAN_FRONTEND=noninteractive
    apt-get update && apt-get install -y \
        curl unzip bzip2 locales \
        python3 python3-pip \
        libnss3 libx11-6 zlib1g libbz2-1.0 liblzma5 libcurl4 libtbb2 \
        && apt-get clean

    # Set up locales
    locale-gen en_US.UTF-8

    # Download and install Cell Ranger 9.0.1
    curl -o cellranger-9.0.1.tar.gz "https://cf.10xgenomics.com/releases/cell-exp/cellranger-9.0.1.tar.gz?Expires=1752894416&Key-Pair-Id=APKAI7S6A5RYOXBWRPDA&Signature=k90ZPpW~TT0TdIt~F8y1WQinPfqRTeoazVre7Kv-KAabFxQqF45nspm0ZB5~Gn2EzBkmQGLLl4STzxoRONuhbAiHkDchv1~8O1f7h5IVJt-R3mcKpfTZuSUypY7psfnZr8qkYg9FJ~QnvTSymwo35pxu7zQrzGB9mz2E--y2ekFSugz0k-TqfdbmFAcKfQJ7ZhgHSUhvUOu4vHDh7heZzDeo1Tifqu13Iw-S-ZQ5SWZ0VbpxWuFsLK2jrr7US7oqDvdpWejkphJ2crogiZKulHOgd1qWnCB5dYDOt5b2d0IVMOHJvM3BRu5oHbgCsClMvZR-3TvEM-ziTpdlH4OjGQ__"
    tar -xzvf cellranger-9.0.1.tar.gz
    mv cellranger-9.0.1 /opt/cellranger
    ln -s /opt/cellranger/cellranger /usr/local/bin/cellranger

